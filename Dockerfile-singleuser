ARG VER=0.9.2
FROM jupyterhub/singleuser:$VER

RUN pip install s3contents dask toolz nose s3fs gcsfs
RUN conda config --system --prepend channels conda-forge && \
    conda config --system --set auto_update_conda false && \
    conda config --system --set show_channel_urls true && \
    conda install --quiet --yes jupyter notebook jupyterlab && \
    conda install --quiet --yes r r-irkernel && \
    conda clean -tipsy && \
    jupyter labextension install @jupyterlab/hub-extension && \
    npm cache clean --force
